import{c as l,P as u,y as i,o as N,m as K,h as S,i as A}from"./index-B6RK4WsZ.js";import{M as I}from"./Manager-BOigk6xn.js";var x=l.createContext({}),L=l.createContext({});function _(r){"@babel/helpers - typeof";return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(r)}var z=["className","cssModule","direction","isOpen","group","size","nav","setActiveFromChild","active","tag","menuRole"];function P(){return P=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r[n]=o[n])}return r},P.apply(this,arguments)}function h(r,t,o){return t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function F(r,t){if(r==null)return{};var o=U(r,t),n,e;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(e=0;e<a.length;e++)n=a[e],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(o[n]=r[n])}return o}function U(r,t){if(r==null)return{};var o={},n=Object.keys(r),e,a;for(a=0;a<n.length;a++)e=n[a],!(t.indexOf(e)>=0)&&(o[e]=r[e]);return o}function V(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function W(r,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function B(r,t,o){return t&&W(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function G(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&T(r,t)}function T(r,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},T(r,t)}function q(r){var t=J();return function(){var n=R(r),e;if(t){var a=R(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return H(this,e)}}function H(r,t){if(t&&(_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g(r)}function g(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(r){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},R(r)}var Q={a11y:u.bool,disabled:u.bool,direction:u.oneOf(["up","down","start","end","left","right"]),group:u.bool,isOpen:u.bool,nav:u.bool,active:u.bool,size:u.string,tag:A,toggle:u.func,children:u.node,className:u.string,cssModule:u.object,dropup:u.bool,inNavbar:u.bool,setActiveFromChild:u.bool,menuRole:u.oneOf(["listbox","menu"])},X={a11y:!0,isOpen:!1,direction:"down",nav:!1,active:!1,inNavbar:!1,setActiveFromChild:!1},Y=[i.space,i.enter,i.up,i.down,i.end,i.home],D=function(r){G(o,r);var t=q(o);function o(n){var e;return V(this,o),e=t.call(this,n),e.addEvents=e.addEvents.bind(g(e)),e.handleDocumentClick=e.handleDocumentClick.bind(g(e)),e.handleKeyDown=e.handleKeyDown.bind(g(e)),e.removeEvents=e.removeEvents.bind(g(e)),e.toggle=e.toggle.bind(g(e)),e.handleMenuRef=e.handleMenuRef.bind(g(e)),e.handleToggleRef=e.handleToggleRef.bind(g(e)),e.containerRef=l.createRef(),e.menuRef=l.createRef(),e.toggleRef=l.createRef(),e}return B(o,[{key:"componentDidMount",value:function(){this.handleProps()}},{key:"componentDidUpdate",value:function(e){this.props.isOpen!==e.isOpen&&this.handleProps()}},{key:"componentWillUnmount",value:function(){this.removeEvents()}},{key:"handleMenuRef",value:function(e){this.menuRef.current=e}},{key:"handleToggleRef",value:function(e){this.toggleRef.current=e}},{key:"handleDocumentClick",value:function(e){if(!(e&&(e.which===3||e.type==="keyup"&&e.which!==i.tab))){var a=this.getContainer(),s=this.getMenu(),d=this.getToggle();if(d){var v=d.contains(e.target),c=s&&s.contains(e.target)&&s!==e.target,p=!1;a&&(p=a.classList.contains("input-group")&&a.classList.contains("dropdown")&&e.target.tagName==="INPUT"),!((v&&!p||c)&&(e.type!=="keyup"||e.which===i.tab))&&this.toggle(e)}}}},{key:"handleKeyDown",value:function(e){var a=this,s=e.target.getAttribute("role")==="menuitem"||e.target.getAttribute("role")==="option",d=this.getMenuCtrl()===e.target,v=i.tab===e.which;if(!(/input|textarea/i.test(e.target.tagName)||v&&!this.props.a11y||v&&!(s||d))&&((Y.indexOf(e.which)!==-1||e.which>=48&&e.which<=90)&&e.preventDefault(),!this.props.disabled)){if(d)if([i.space,i.enter,i.up,i.down].indexOf(e.which)>-1)this.props.isOpen||this.toggle(e),setTimeout(function(){var b;return(b=a.getMenuItems()[0])===null||b===void 0?void 0:b.focus()});else if(this.props.isOpen&&v){var c;e.preventDefault(),(c=this.getMenuItems()[0])===null||c===void 0||c.focus()}else this.props.isOpen&&e.which===i.esc&&this.toggle(e);if(this.props.isOpen&&s){if([i.tab,i.esc].indexOf(e.which)>-1)this.toggle(e),this.getMenuCtrl().focus();else if([i.space,i.enter].indexOf(e.which)>-1)e.target.click(),this.getMenuCtrl().focus();else if([i.down,i.up].indexOf(e.which)>-1||[i.n,i.p].indexOf(e.which)>-1&&e.ctrlKey){var p=this.getMenuItems(),f=p.indexOf(e.target);i.up===e.which||i.p===e.which&&e.ctrlKey?f=f!==0?f-1:p.length-1:(i.down===e.which||i.n===e.which&&e.ctrlKey)&&(f=f===p.length-1?0:f+1),p[f].focus()}else if(i.end===e.which){var w=this.getMenuItems();w[w.length-1].focus()}else if(i.home===e.which){var O=this.getMenuItems();O[0].focus()}else if(e.which>=48&&e.which<=90)for(var y=this.getMenuItems(),k=String.fromCharCode(e.which).toLowerCase(),m=0;m<y.length;m+=1){var M=y[m].textContent&&y[m].textContent[0].toLowerCase();if(M===k){y[m].focus();break}}}}}},{key:"handleProps",value:function(){this.props.isOpen?this.addEvents():this.removeEvents()}},{key:"getContextValue",value:function(){return{toggle:this.toggle,isOpen:this.props.isOpen,direction:this.props.direction==="down"&&this.props.dropup?"up":this.props.direction,inNavbar:this.props.inNavbar,disabled:this.props.disabled,onMenuRef:this.handleMenuRef,onToggleRef:this.handleToggleRef,menuRole:this.props.menuRole}}},{key:"getContainer",value:function(){return this.containerRef.current}},{key:"getMenu",value:function(){return this.menuRef.current}},{key:"getToggle",value:function(){return this.toggleRef.current}},{key:"getMenuCtrl",value:function(){return this._$menuCtrl?this._$menuCtrl:(this._$menuCtrl=this.getToggle(),this._$menuCtrl)}},{key:"getItemType",value:function(){return this.props.menuRole==="listbox"?"option":"menuitem"}},{key:"getMenuItems",value:function(){var e=this.getMenu()||this.getContainer();return[].slice.call(e.querySelectorAll('[role="'.concat(this.getItemType(),'"]')))}},{key:"addEvents",value:function(){var e=this;["click","touchstart","keyup"].forEach(function(a){return document.addEventListener(a,e.handleDocumentClick,!0)})}},{key:"removeEvents",value:function(){var e=this;["click","touchstart","keyup"].forEach(function(a){return document.removeEventListener(a,e.handleDocumentClick,!0)})}},{key:"toggle",value:function(e){return this.props.disabled?e&&e.preventDefault():this.props.toggle(e)}},{key:"render",value:function(){var e,a=this,s=N(this.props,["toggle","disabled","inNavbar","a11y"]),d=s.className,v=s.cssModule,c=s.direction,p=s.isOpen,f=s.group,w=s.size,O=s.nav,y=s.setActiveFromChild,k=s.active,m=s.tag;s.menuRole;var M=F(s,z),b=m||(O?"li":"div"),E=!1;y&&l.Children.map(this.props.children[1].props.children,function(C){C&&C.props.active&&(E=!0)});var j=K(S(d,O&&k?"active":!1,y&&E?"active":!1,(e={"btn-group":f},h(e,"btn-group-".concat(w),!!w),h(e,"dropdown",!f),h(e,"dropup",c==="up"),h(e,"dropstart",c==="start"||c==="left"),h(e,"dropend",c==="end"||c==="right"),h(e,"show",p),h(e,"nav-item",O),e)),v);return this.context.insideInputGroup?l.createElement(x.Provider,{value:this.getContextValue()},l.createElement(I,null,l.Children.map(this.props.children,function(C){return l.cloneElement(C,{onKeyDown:a.handleKeyDown})}))):l.createElement(x.Provider,{value:this.getContextValue()},l.createElement(I,null,l.createElement(b,P({},M,h({},typeof b=="string"?"ref":"innerRef",this.containerRef),{onKeyDown:this.handleKeyDown,className:j}))))}}]),o}(l.Component);D.propTypes=Q;D.defaultProps=X;D.contextType=L;export{D,L as I,x as a};
